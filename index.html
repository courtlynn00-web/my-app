<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mystery Mood â€” Tracker â™¡</title>
<meta name="description" content="Peachy kawaii mood tracker â€” reveal a mood, save logs, collect quotes. Data stored locally." />

<style>
  :root{
    --peach:#FAD7C8;
    --peach-2:#FDEDE5;
    --brown:#6A4A3C;
    --accent:#F8B9C4;
    --white:#ffffff;
    --radius:16px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
    background: linear-gradient(180deg,var(--peach-2),#fff);
    color:var(--brown);
    padding:22px;
    -webkit-font-smoothing:antialiased;
  }

  .wrap{max-width:760px;margin:0 auto;}
  header{text-align:center;margin-bottom:10px}
  .logo{
    width:86px;height:86px;border-radius:18px;background:var(--peach);
    display:inline-flex;align-items:center;justify-content:center;font-size:34px;color:var(--white);box-shadow:0 8px 22px rgba(0,0,0,0.06);
  }
  h1{margin:12px 0 4px;font-size:26px}
  p.lead{margin:0;color:rgba(106,74,60,0.85)}

  .card{background:var(--white);border-radius:var(--radius);padding:16px;margin:18px 0;box-shadow:0 8px 20px rgba(0,0,0,0.06);}
  .center{text-align:center}

  #todayMood{font-size:20px;padding:18px;border-radius:12px;background:linear-gradient(180deg,var(--peach),var(--peach-2));}
  .bigBtn{display:inline-block;background:linear-gradient(180deg,var(--accent),var(--peach));border:none;color:white;padding:12px 18px;border-radius:14px;font-weight:700;font-size:16px;cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,0.08);margin-top:12px}
  .smallBtn{background:transparent;border:2px solid var(--peach);padding:8px 12px;border-radius:12px;color:var(--brown);cursor:pointer;margin-left:8px}

  .mood-grid{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:12px}
  .mood-item{background:var(--peach-2);border-radius:12px;padding:10px 12px;cursor:pointer;border:2px solid transparent;min-width:94px;text-align:center}
  .mood-item:hover{border-color:var(--accent);transform:translateY(-3px);transition:all .12s}

  .note{width:100%;padding:10px;border-radius:10px;border:1px solid #eee;margin-top:10px;font-size:14px}

  .controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:12px}

  ul.logs{list-style:none;padding:0;margin:0;max-height:220px;overflow:auto}
  ul.logs li{padding:10px;border-bottom:1px dashed #eee;font-size:14px}
  .muted{color:#7a7169;font-size:13px}

  .footer{margin:18px 0;text-align:center;color:rgba(106,74,60,0.7);font-size:13px}
  .button-row{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:10px}

  @media(min-width:720px){
    .card{padding:22px}
    #todayMood{font-size:24px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">â™¡</div>
      <h1>Mystery Mood â€” Tracker</h1>
      <p class="lead">Tap to reveal a mood, add a note, save it â€” build your mood history. Data stays on your device.</p>
    </header>

    <section class="card center">
      <h2>Today</h2>
      <div id="todayMood">No mood logged yet â™¡</div>

      <div class="button-row">
        <button id="mysteryBtn" class="bigBtn">âœ¨ Mystery Mood âœ¨</button>
        <button id="saveBtn" class="smallBtn">Save Log</button>
        <button id="exportBtn" class="smallBtn">Export CSV</button>
        <button id="clearBtn" class="smallBtn" title="Delete all saved logs">Clear All</button>
      </div>

      <textarea id="note" class="note" rows="2" placeholder="Add a short note (optional)"></textarea>

      <div class="muted" style="margin-top:10px">Or pick a mood manually:</div>
      <div class="mood-grid" id="moodGrid"></div>
    </section>

    <section class="card">
      <h3>Recent Logs</h3>
      <div id="recentArea"><p class="muted">No logs yet â€” save your mood to build a history.</p></div>
      <div style="height:10px"></div>
      <div style="text-align:center">
        <button id="viewAll" class="smallBtn">View All Logs</button>
      </div>
      <div id="allLogs" style="display:none;margin-top:12px;">
        <ul class="logs" id="logsList"></ul>
      </div>
    </section>

    <div class="footer">
      Made with â™¡ â€” Peachy Kawaii â€¢ Data stored only on this device.
    </div>
  </div>

<script>
/* -------------------------
   Data & Quotes for moods
   ------------------------- */
const MOODS = [
  { id: 'calm', label:'Calm â˜ï¸', color:'#FFF7F3', quote:"Breathe. You are doing your best." },
  { id: 'happy', label:'Happy â˜€ï¸', color:'#FFFDF0', quote:"Little joys add up â€” notice them." },
  { id: 'cozy', label:'Cozy â˜•', color:'#FFF6F0', quote:"Wrap yourself in small comforts." },
  { id: 'excited', label:'Excited âœ¨', color:'#FFFDF6', quote:"Use that spark â€” create something tiny." },
  { id: 'sad', label:'Sad ðŸŒ§ï¸', color:'#F5F3FA', quote:"Feelings come and go. This one will too." },
  { id: 'anxious', label:'Anxious âš¡', color:'#FFF6F4', quote:"Ground with 3 slow breaths." },
  { id: 'content', label:'Content ðŸ¾', color:'#FFF9F6', quote:"This simple moment matters." }
];

const STORAGE_KEY = 'mystery_logs_v1';

/* -------------------------
   Utilities
   ------------------------- */
function $id(id){ return document.getElementById(id); }
function nowISO(){ return new Date().toISOString(); }
function loadLogs(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }catch(e){return []} }
function saveLogs(arr){ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }

/* -------------------------
   UI actions
   ------------------------- */
function renderMoodGrid(){
  const grid = $id('moodGrid');
  grid.innerHTML = '';
  MOODS.forEach(m=>{
    const d = document.createElement('div');
    d.className = 'mood-item';
    d.style.background = m.color;
    d.innerHTML = `<div style="font-weight:700">${m.label}</div><div style="font-size:13px;margin-top:6px;color:#6b5042">${m.quote.split(' ').slice(0,6).join(' ')}â€¦</div>`;
    d.onclick = ()=>selectMood(m.id);
    grid.appendChild(d);
  });
}

let currentMood = null;
function selectMood(id){
  const m = MOODS.find(x=>x.id===id);
  if(!m) return;
  currentMood = m;
  $id('todayMood').textContent = m.label + ' â€” ' + m.quote;
  $id('note').focus();
}

/* Mystery pick */
function mysteryPick(){
  const i = Math.floor(Math.random()*MOODS.length);
  selectMood(MOODS[i].id);
}

/* Save log */
function saveLog(){
  if(!currentMood){
    alert('Please pick or reveal a mood first.');
    return;
  }
  const logs = loadLogs();
  const note = $id('note').value.trim();
  const entry = { id: currentMood.id, label: currentMood.label, quote: currentMood.quote, note, time: nowISO() };
  logs.unshift(entry);
  saveLogs(logs.slice(0,1000));
  $id('note').value = '';
  showRecent();
}

/* Show recent */
function showRecent(){
  const logs = loadLogs();
  const recentArea = $id('recentArea');
  if(!logs.length){
    recentArea.innerHTML = '<p class="muted">No logs yet â€” save your mood to build a history.</p>';
    $id('allLogs').style.display='none';
    return;
  }
  const last = logs[0];
  recentArea.innerHTML = `<div style="padding:12px;border-radius:12px;background:var(--peach-2)"><strong>${last.label}</strong><div style="margin-top:6px;color:#6b5042">${last.quote}</div><div style="margin-top:8px;font-size:13px;color:#7a7169">${(new Date(last.time)).toLocaleString()}</div>${last.note?'<div style="margin-top:8px;padding:8px;border-radius:10px;background:#fff;font-size:13px">Note: '+escapeHtml(last.note)+'</div>':''}</div>`;
  renderAllLogs();
}

/* Render all logs list */
function renderAllLogs(){
  const logs = loadLogs();
  const list = $id('logsList');
  list.innerHTML = '';
  if(!logs.length){ list.innerHTML='<li class="muted">No logs yet.</li>'; return; }
  logs.forEach((l, idx)=>{
    const li = document.createElement('li');
    li.innerHTML = `<strong>${l.label}</strong> â€” <span style="color:#7a7169">${(new Date(l.time)).toLocaleString()}</span><div style="margin-top:6px;color:#6b5042">${escapeHtml(l.quote)}</div>${l.note?'<div style="margin-top:6px;font-size:13px">Note: '+escapeHtml(l.note)+'</div>':''}`;
    list.appendChild(li);
  });
}

/* Export CSV */
function exportCSV(){
  const logs = loadLogs();
  if(!logs.length){ alert('No logs to export.'); return; }
  const rows = [['time','mood_id','mood_label','quote','note']];
  logs.slice().reverse().forEach(l=>{
    // reverse so CSV oldest->newest
    rows.push([l.time, l.id, l.label, l.quote.replace(/"/g,'""'), l.note.replace(/"/g,'""')]);
  });
  const csv = rows.map(r=>r.map(cell => `"${cell}"`).join(',')).join('\\n');
  const blob = new Blob([csv], {type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'mystery_mood_logs.csv';
  a.click();
  URL.revokeObjectURL(url);
}

/* Clear logs */
function clearAll(){
  if(!confirm('Clear all saved logs? This cannot be undone.')) return;
  saveLogs([]);
  showRecent();
  alert('All logs cleared.');
}

/* Helper */
function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>"']/g, function(m){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\\'':'&#39;'}[m]; }); }

/* Init */
document.addEventListener('DOMContentLoaded', ()=>{
  renderMoodGrid();
  $id('mysteryBtn').addEventListener('click',=>{
    mysteryPick();
  });
  $id('saveBtn').addEventListener('click', saveLog);
  $id('exportBtn').addEventListener('click', exportCSV);
  $id('clearBtn').addEventListener('click', clearAll);
  $id('viewAll').addEventListener('click', ()=>{
    const el = $id('allLogs');
    el.style.display = el.style.display === 'block' ? 'none' : 'block';
    renderAllLogs();
  });

  // restore last mood if exists
  const logs = loadLogs();
  if(logs.length) selectMood(logs[0].id);
  showRecent();
});
</script>
</body>
</html>
